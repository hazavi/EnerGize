<app-loading *ngIf="isLoading"></app-loading>

<div class="app-container">
  <nav id="sidebar" [class.close]="isCollapsed">
    <ul>
      <li>
        <span class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#d6cf00">
            <path
              d="M306.92-119.23 468.46-400 160-436.15l450-404.62h44.62L489.23-559.23 800-523.85 350-119.23h-43.08Z" />
          </svg>
          <span>EnerGize</span>
        </span>
        <button (click)="toggleSidebar()" id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
            <path
              d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm280-80h280v-560H480v560Z" />
          </svg>
        </button>
      </li>
      <li>
        <a routerLink="/home">
          <i class="fa-solid fa-house"></i>
          <span>Home</span>
        </a>
      </li>
      <li>
        <a routerLink="/workout">
          <i class="fa-solid fa-plus fa-lg"></i>
          <span>Workout</span>
        </a>
      </li>
      <li>
        <a routerLink="/exercises">
          <i class="fa-solid fa-dumbbell"></i>
          <span>Exercises</span>
        </a>
      </li>




      <li>

        <!-- If user is logged in -->
        <ng-container *ngIf="username; else loginTemplate">
          <a id="profile-link" (click)="toggleProfileMenu()">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed">
              <path
                d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z" />
            </svg>
            <span>{{ username }}</span>
          </a>

          <!-- Submenu -->
          <ul id="profile-submenu" class="submenu" [ngClass]="{'admin': isUserAdmin, 'collapsed': isCollapsed}"
            [style.display]="isProfileMenuOpen && !isCollapsed ? 'block' : 'none'">
            <li>
              <!-- Admin link (visible only for admin users) -->
              <a *ngIf="isUserAdmin" routerLink="/admin" routerLinkActive="active">Admin</a>
            </li>
            <li>
              <a routerLink="/settings">Settings</a>
            </li>
            <li>
              <a id="logout-btn" (click)="logout()">Logout</a>
            </li>
          </ul>
        </ng-container>

        <!-- Login link if user is not logged in -->
        <ng-template #loginTemplate>
          <a id="profile-link" routerLink="/login" routerLinkActive="active">

            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
              <path
                d="M480-120v-80h280v-560H480v-80h280q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H480Zm-80-160-55-58 102-102H120v-80h327L345-622l55-58 200 200-200 200Z" />
            </svg>
            <span id="profile-text">Login</span>

          </a>
        </ng-template>


      </li>
    </ul>
  </nav>
  <main>
    <div class="container">
      <router-outlet />
    </div>
  </main>
</div>